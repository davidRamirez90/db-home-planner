<section class="board" aria-label="Departures board">
  <header class="board-header">
    <div class="board-title">
      <span class="board-icon" aria-hidden="true">âœˆ</span>
      <span>{{ boardTitle() }}</span>
    </div>
    <div class="board-right">
      <div class="board-meta">
        <span class="board-label">STATUS</span>
        <span class="board-status" [attr.data-status]="requestStatus()">
          {{ displayStatus() }}
        </span>
      </div>
      <div class="board-clock" aria-hidden="true">
        @for (char of toChars(displayClock()); track $index; let i = $index) {
          <app-segment-display [value]="char" [delayMs]="i * 20" />
        }
      </div>
      <span class="sr-only">CURRENT TIME {{ displayClock() }}</span>
    </div>
  </header>

  @if (errorMessage()) {
    <p class="board-error">{{ displayErrorMessage() }}</p>
  }

  @if (!errorMessage() && requestStatus() === 'success' && boardRows().length === 0) {
    <p class="board-empty">NO TRACKED ROUTES YET. ADD ONE IN THE ADMIN CONFIG.</p>
  }

  <div class="board-grid" role="table" aria-label="Departures overview">
    <div class="board-row board-row--header" role="row">
      <span class="board-cell" role="columnheader">STATION</span>
      <span class="board-cell" role="columnheader">TIME</span>
      <span class="board-cell" role="columnheader">LINE</span>
      <span class="board-cell" role="columnheader">COUNTDOWN</span>
      <span class="board-cell" role="columnheader">STATUS</span>
      <span class="board-cell" role="columnheader">ACTION</span>
    </div>

    @for (row of boardRows(); track $index) {
      <div class="board-row" role="row">
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.station); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.station }}</span>
        </span>
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.departure); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.departure }}</span>
        </span>
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.line); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.line }}</span>
        </span>
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.countdown); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.countdown }}</span>
        </span>
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.status); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.status }}</span>
        </span>
        <span class="board-cell" role="cell">
          <span class="board-text" aria-hidden="true">
            @for (char of toChars(row.action); track $index; let i = $index) {
              <app-segment-display [value]="char" [delayMs]="i * 35" />
            }
          </span>
          <span class="sr-only">{{ row.action }}</span>
        </span>
      </div>
    }
  </div>
</section>
